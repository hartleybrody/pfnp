<!doctype>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Meal App</title>
    <link rel="icon" type="image/png" href="https://ga-core-production-herokuapp-com.global.ssl.fastly.net/assets/shared/favicon-dd59129eb9fbd6cda4571e8a21ff2853.ico" />

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-MfvZlkHCEqatNoGiOXveE8FIwMzZg4W85qfrfIFBfYc= sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

  </head>

  <body>
    <div class="container">

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h1>
                    <span class="glyphicon glyphicon-apple" aria-hidden="true"></span>
                    A Simple Meal Tracking App
                </h1>
                <hr />
            </div>
        </div><!--.row-->

        <div class="row">
            <div class="col-md-8 col-md-offset-2">

                <p class="lead">
                    For our final class project, we'll be building a simple meal tracking application. To save us a lot of time, the backend for this application is already built and hosted. You'll be in charge of building a frontend for the application that interacts with the existing backend via an API. You'll use the backend to store your application's data.
                </p>

                <h4>Steps to Follow</h4>
                <ol>
                    <li>Start by <a href="https://pfnp-backend.herokuapp.com/" target="_blank">reading the documentation</a> on the backend API that we'll be using.</li>
                    <li>Add a form to this page that allows you to enter a new meal</li>
                    <li>Make sure that you get a successful response when submitting the form</li>
                    <li>Write some Javascript that makes an AJAX request to load your meals</li>
                    <li>For each of the meals that's returned, add some HTML content to the page</li>
                    <li>Add a "delete" button next to a meal that triggers an AJAX request that tells the backend to remove that meal</li>
                </ol>
                <hr>

            </div>
        </div><!--.row-->


        <div class="row">
            <div class="col-md-8 col-md-offset-2">

                <p class="text-muted">Your form should go here</p>
                <hr>

                <form class="form" action="http://pfnp-backend.herokuapp.com/meals/hartley/" method="post">
                    <div class="form-group">
                        <label>Meal Name</label>
                        <input type="text" name="meal-name" class="form-control">
                    </div>

                    <div class="form-group">
                        <label>Total Calories</label>
                        <input type="text" name="calories" class="form-control">
                    </div>

                    <div class="form-group">
                        <label>Total Carbohydrates</label>
                        <input type="text" name="carbs" class="form-control">
                    </div>

                    <input type="submit" class="btn btn-primary" value="Create Meal" />
                </form>

            </div>
        </div><!--.row-->


        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <div id="meals">

                    <p class="text-muted">Your meals should be listed here</p>
                    <hr>

                </div>
            </div>
        </div><!--.row-->

    </div><!--.container-->



    <script type="text/template" id="meal-template">
        <div class="meal">
            <h3>{{food-name}}</h3>
            <p>{{calories}} Calories</p>
            <p>{{carbs}} Carbohydrates</p>
        </div>
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript">

    $(document).ready(function(){

        // when the page first loads, call the API to get all of our meals
        $.ajax("http://pfnp-backend.herokuapp.com/meals/hartley/", {
            success: function(data){
                console.log("Here's what we got back from the server:")

                $.each(data, function(_, meal){

                    // show the meal's data in the console so we see what we're working with
                    console.log(meal);

                    // build our own custom HTML for displaying each meal
                    var mealHtml = buildMealHtml(meal);

                    // add this meal's HTML to the page
                    $("#meals").append(mealHtml)
                })

            }
        });

        // take in a JSON dictionary of meal information, and return a string of HTML
        // don't edit this
        function buildMealHtml(meal){
            var template = $("#meal-template").html();
            $.each(meal, function(k, v){
                var re = new RegExp("{{" + k + "}}","g");
                template = template.replace(re, v);
            })
            return template;
        }

    })

    </script>

  </body>
</html>